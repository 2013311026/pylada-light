

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>augmentDb.py &mdash; Pylada 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="Pylada 1.0 documentation" href="../index.html" />
    <link rel="up" title="NRELMatDB database builder pipeline" href="index.html" />
    <link rel="next" title="execMimic.py" href="execMimic.html" />
    <link rel="prev" title="NREL MatDB Web Server Overview" href="webServer.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="execMimic.html" title="execMimic.py"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="webServer.html" title="NREL MatDB Web Server Overview"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Pylada 1.0 documentation</a> &raquo;</li>
          <li><a href="../userguide.html" >User Guide</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">NRELMatDB database builder pipeline</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-nrelmat.augmentDb">
<span id="augmentdb-py"></span><h1>augmentDb.py<a class="headerlink" href="#module-nrelmat.augmentDb" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="nrelmat.augmentDb.main">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">main</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/nrelmat/augmentDb.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.main" title="Permalink to this definition">¶</a></dt>
<dd><p>This program adds additional information to the model database table.
The following functions in this file fill the indicated columns
in the model table.  The columns must have been created previously
by the fillDbVasp.py function createTable.</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="18%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Column</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>addChemform</td>
<td>formula</td>
<td>Standard chemical formula: <tt class="docutils literal"><span class="pre">&quot;H2</span> <span class="pre">O&quot;</span></tt>.</td>
</tr>
<tr class="row-odd"><td>addChemform</td>
<td>sortedformula</td>
<td>Chemical formula: <tt class="docutils literal"><span class="pre">&quot;H2</span> <span class="pre">O&quot;</span></tt>, with
atoms sorted in alphabetic order.</td>
</tr>
<tr class="row-even"><td>addChemForm</td>
<td>chemtext</td>
<td>Structured formula, easier for parsing.
Every token is surrounded by spaces, and
single occurance atoms have the explicit
&#8220;1&#8221; count:
<tt class="docutils literal"><span class="pre">&quot;</span> <span class="pre">H</span> <span class="pre">2</span> <span class="pre">O</span> <span class="pre">1</span> <span class="pre">&quot;</span></tt>.</td>
</tr>
<tr class="row-odd"><td>addMinenergy</td>
<td>minenergyid</td>
<td>== mident having min energyperatom
for this formula and finalspacegroupnum.</td>
</tr>
</tbody>
</table>
<p>Command line parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="15%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>-bugLev</strong></td>
<td>integer</td>
<td>Debug level.  Normally 0.</td>
</tr>
<tr class="row-odd"><td><strong>-useCommit</strong></td>
<td>boolean</td>
<td>false/true: do we commit changes to the DB.</td>
</tr>
<tr class="row-even"><td><strong>-inSpec</strong></td>
<td>string</td>
<td>JSON file containing DB parameters.  See below.</td>
</tr>
</tbody>
</table>
<p><strong>inSpec File Parameters:</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>dbhost</strong></td>
<td>Database hostname.</td>
</tr>
<tr class="row-odd"><td><strong>dbport</strong></td>
<td>Database port number.</td>
</tr>
<tr class="row-even"><td><strong>dbuser</strong></td>
<td>Database user name.</td>
</tr>
<tr class="row-odd"><td><strong>dbpswd</strong></td>
<td>Database password.</td>
</tr>
<tr class="row-even"><td><strong>dbname</strong></td>
<td>Database database name.</td>
</tr>
<tr class="row-odd"><td><strong>dbschema</strong></td>
<td>Database schema name.</td>
</tr>
<tr class="row-even"><td><strong>dbtablemodel</strong></td>
<td>Database name of the &#8220;model&#8221; table.</td>
</tr>
</tbody>
</table>
<p><strong>inSpec file example:</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
  <span class="s">&quot;dbhost&quot;</span>         <span class="p">:</span> <span class="s">&quot;scctest&quot;</span><span class="p">,</span>
  <span class="s">&quot;dbport&quot;</span>         <span class="p">:</span> <span class="s">&quot;6432&quot;</span><span class="p">,</span>
  <span class="s">&quot;dbuser&quot;</span>         <span class="p">:</span> <span class="s">&quot;x&quot;</span><span class="p">,</span>
  <span class="s">&quot;dbpswd&quot;</span>         <span class="p">:</span> <span class="s">&quot;x&quot;</span><span class="p">,</span>
  <span class="s">&quot;dbname&quot;</span>         <span class="p">:</span> <span class="s">&quot;cidlada&quot;</span><span class="p">,</span>
  <span class="s">&quot;dbschema&quot;</span>       <span class="p">:</span> <span class="s">&quot;satom&quot;</span><span class="p">,</span>
  <span class="s">&quot;dbtablemodel&quot;</span>   <span class="p">:</span> <span class="s">&quot;model&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="nrelmat.augmentDb.augmentDb">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">augmentDb</tt><big>(</big><em>bugLev</em>, <em>useCommit</em>, <em>inSpec</em><big>)</big><a class="reference internal" href="../_modules/nrelmat/augmentDb.html#augmentDb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.augmentDb" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds additional information to the model database table.</p>
<p>See documentation for the <a class="reference internal" href="#nrelmat.augmentDb.main" title="nrelmat.augmentDb.main"><tt class="xref py py-func docutils literal"><span class="pre">main()</span></tt></a> function.</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li><p class="first">bugLev (int): Debug level.  Normally 0.</p>
</li>
<li><p class="first">useCommit (bool): do we commit changes to the DB.</p>
</li>
<li><dl class="first docutils">
<dt>inSpec (str): Name of JSON file containing DB parameters.</dt>
<dd><p class="first last">See description at <a class="reference internal" href="#nrelmat.augmentDb.main" title="nrelmat.augmentDb.main"><tt class="xref py py-func docutils literal"><span class="pre">main()</span></tt></a>.</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Returns</strong></p>
<ul class="simple">
<li>None</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="nrelmat.augmentDb.addMinenergy">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">addMinenergy</tt><big>(</big><em>bugLev</em>, <em>objPairs</em><big>)</big><a class="reference internal" href="../_modules/nrelmat/augmentDb.html#addMinenergy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.addMinenergy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the min energyperatom for each formula.</p>
<p>minenergyid == the mident of the row having the min energyperatom
for this formula.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li>bugLev (int): Debug level; normally 0.</li>
<li>curObjs: current objects, one per DB row</li>
<li>newObjs: objects with new fields only, one per DB row</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="nrelmat.augmentDb.addEnthalpy">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">addEnthalpy</tt><big>(</big><em>bugLev</em>, <em>objPairs</em><big>)</big><a class="reference internal" href="../_modules/nrelmat/augmentDb.html#addEnthalpy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.addEnthalpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the enthalpy of formation per atom, for all structures.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li>bugLev (int): Debug level; normally 0.</li>
<li>curObjs: current objects, one per DB row</li>
<li>newObjs: objects with new fields only, one per DB row</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="nrelmat.augmentDb.calcEnthalpy">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">calcEnthalpy</tt><big>(</big><em>bugLev</em>, <em>mident</em>, <em>typenames</em>, <em>typenums</em>, <em>typepseudos</em>, <em>energy</em><big>)</big><a class="reference internal" href="../_modules/nrelmat/augmentDb.html#calcEnthalpy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.calcEnthalpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the enthalpy of formation per atom, for a single structure.</p>
<p><strong>Parameters (using example magnetitie, Fe3 O4)</strong>:</p>
<ul>
<li><p class="first">mident (int): The unique DB identifier.</p>
</li>
<li><p class="first">typenames (str[]): List of unique type names, ex. [&#8216;Fe&#8217;, &#8216;O&#8217;]</p>
</li>
<li><p class="first">typenums (int[]): Number of each unique type, ex. [3, 4]</p>
</li>
<li><dl class="first docutils">
<dt>typepseudos (str[]): Pseudopotential for each type,</dt>
<dd><p class="first last">[&#8216;PAW_PBE Fe 06Sep2000&#8217;, &#8216;PAW_PBE O_s 07Sep2000&#8217;]</p>
</dd>
</dl>
</li>
<li><p class="first">energy (float): final total energy without entropy, per atom in cell</p>
</li>
</ul>
<p><strong>Returns</strong></p>
<ul class="simple">
<li>enthalpy (float): enthalpy of formation per atom</li>
</ul>
<p>See:
DOI: 10.1103/PhysRevB.85.115104</p>
<p><a class="reference external" href="http://prb.aps.org/pdf/PRB/v85/i11/e115104">http://prb.aps.org/pdf/PRB/v85/i11/e115104</a>
Correcting density functional theory for accurate predictions
of compound enthalpies of formation:
Fitted elemental-phase reference energies
Vladan Stevanovic, Stephan Lany, Xiuwen Zhang, Alex Zunger</p>
<p>page 11, Table V: mu^{FERE}</p>
<p>Email from Stevanovic, Monday, August 12, 2013 5:45 PM
For the enthalpy of formation calculations I will use the
following example. So, if we have a ternary compound with the
chemical formula A_mB_nX_l, where A, B and X represent the
symbols of the elements forming the compound and if N=m+n+l the
total number of atoms in the compound the enthalpy of formation
can be calculated as:</p>
<blockquote>
<div>dHf (eV/atom) = [Etot(eV/atom) * N - (m*musMap[&#8216;A&#8217;]
+ n*musMap[&#8216;B&#8217;] + l*musMap[&#8216;X&#8217;] ) ] / N</div></blockquote>
<p>where Etot(eV/atom) is the VASP total energy per atom which is
currently listed in the database and musMap[&#8216;A&#8217;],
musMap[&#8216;B&#8217;], and musMap[&#8216;X&#8217;] you read from the attached
dictionary.</p>
<p>This is the same as:</p>
<blockquote>
<div>enthalpy = - sum_i( n_i * mus_i) / sum( n_i)</div></blockquote>
<p>where n_i = number of element i, and mus_i = mus value for element i.
We use this calculation for ALL structures, not just ternaries.</p>
</dd></dl>

<dl class="function">
<dt id="nrelmat.augmentDb.throwerr">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">throwerr</tt><big>(</big><em>msg</em><big>)</big><a class="reference internal" href="../_modules/nrelmat/augmentDb.html#throwerr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.throwerr" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints an error message and raises Exception.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li>msg (str): Error message.</li>
</ul>
<p><strong>Returns</strong></p>
<ul class="simple">
<li>(Never returns)</li>
</ul>
<p><strong>Raises</strong></p>
<ul class="simple">
<li>Exception</li>
</ul>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="webServer.html"
                        title="previous chapter">NREL MatDB Web Server Overview</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="execMimic.html"
                        title="next chapter">execMimic.py</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/nrelmatdb/augmentDb.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="execMimic.html" title="execMimic.py"
             >next</a> |</li>
        <li class="right" >
          <a href="webServer.html" title="NREL MatDB Web Server Overview"
             >previous</a> |</li>
        <li><a href="../index.html">Pylada 1.0 documentation</a> &raquo;</li>
          <li><a href="../userguide.html" >User Guide</a> &raquo;</li>
          <li><a href="index.html" >NRELMatDB database builder pipeline</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Mayeul d&#39;Avezac.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>